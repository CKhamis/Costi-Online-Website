<!DOCTYPE html>
<html xml:th="https://www.thymeleaf.org">
<head th:replace="Components :: head('Home')"></head>
<body class="bg-1 text-1">
<div th:replace="Components :: main-navigation"></div>
<div th:replace="Components :: timer-box"></div>
<div th:replace="Components :: toast-box"></div>

<!-- Desktop -->
<div class="p-0 m-0 overflow-hidden">
    <div class="container-fluid p-0 overflow-hidden d-none d-lg-block bg-black" style="height:600px">
        <div class="position-absolute p-5" style="z-index:1;height:600px; width:100%">
            <div class="container-fluid" style="padding-top:160px;">
                <img th:src="@{/icons/CO White.png}" class="img-fluid mb-2 banner-logo" style="width:0%;margin-left:50%"/>
                <h3 class="fw-bold text-white changing-text text-center">:(</h3>
                <p class="col-md-8 fs-5 text-white text-center w-100" th:text="|Version: ${version}|">Version X</p>
            </div>
        </div>
        <video class="w-100" autoplay preload="true" loop="loop" style="margin-top:-150px;opacity:.5; " muted>
            <source th:src="@{/videos/banners/Costi Online Home Banner.m4v}" type="video/mp4">
            video not supported
        </video>
    </div>
</div>

<!-- Mobile -->
<div class="container pt-5 d-xs-block d-lg-none mt-5">
    <div class="p-0 mb-4 border-box bg-black">
        <div class="container-fluid p-0 overflow-hidden" style="height:300px;">
            <div class="position-absolute p-5 text-white" style="z-index:1;">
                <img th:src="@{/icons/CO White.png}" class="img-fluid mb-2" style="width:80%;margin-left:10%"/>
                <h3 class="fw-bold text-white changing-text text-center">:(</h3>
                <p class="col-md-8 fs-4 text-white text-center w-100" th:text="|Version: ${version}|">Version X</p>
            </div>
            <video style="width:310%; opacity:.5; margin-left:-400px" autoplay preload="true" loop="loop" muted>
                <source th:src="@{/videos/banners/Costi Online Home Banner.m4v}" type="video/mp4">
                video not supported
            </video>
        </div>
    </div>
</div>

<main>
    <div class="container mt-3">
        <h3 th:if="${isAnnouncement}">üì¢Announcements</h3>
        <div th:each="message : ${announcements}">
            <div th:replace="Components :: message" class="mt-2"></div>
        </div>
    </div>

    <!-- Quick Links-->
    <div class="container mt-3">
        <div th:replace="Components :: flash" class="mt-2"></div>
        <div class="row mt-2" id="quick-links">
            <div class="col col-12 col-lg-4" style="margin-top: 100px; opacity:0;">
                <div class="border-box text-1 p-4 mb-4">
                    <h4 class="fw-bold">üìñView Costipedia</h4>
                    <p>Costipedia is a wikipedia like feature that is about Costi</p>
                    <a href="/Wiki" type="button" class="btn btn-primary btn-sm">Explore Costipedia</a>
                </div>
            </div>
            <div class="col col-12 col-lg-4" style="margin-top: 100px; opacity:0;">
                <div class="border-box text-1 p-4  mb-4">
                    <h4 class="fw-bold">üñºÔ∏èStay Up to Date</h4>
                    <p>Check out Costi Newsroom, featuring posts I make in real time!</p>
                    <a href="/Newsroom" type="button" class="btn btn-primary btn-sm">Newsroom</a>
                </div>
            </div>
            <div class="col col-12 col-lg-4" style="margin-top: 100px; opacity:0;">
                <div class="border-box text-1 p-4 mb-4">
                    <h4 class="fw-bold">üß™Check Out Previous Projects</h4>
                    <p>View previous coding-based projects I have made from over a decade ago</p>
                    <a href="/Projects" type="button" class="btn btn-primary btn-sm">View Projects</a>
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="highlights">
        <h2 class="pb-2 border-bottom">Recent Highlights</h2>
        <div id="home-slideshow" class="carousel slide mb-2" data-bs-ride="carousel">

            <!-- Indicators/dots -->
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="2"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="3"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="4"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="5"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="6"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="7"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="8"></button>
                <button type="button" data-bs-target="#home-slideshow" data-bs-slide-to="9"></button>
            </div>

            <!-- The slideshow/carousel -->
            <div class="carousel-inner">
                <div class="carousel-item active" th:object="${slide1}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>

                    </div>
                </div>
                <div class="carousel-item" th:object="${slide2}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide3}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide4}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide5}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide6}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide7}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide8}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide9}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
                <div class="carousel-item" th:object="${slide10}">
                    <img th:src="@{*{imagePath}}" th:alt="*{getSubtitle()}" class="slide">
                    <div class="carousel-caption newsroom-slide-caption">
                        <a class="text-1" th:href="|/Newsroom/${slide1.getId()}/view|"><h3 th:text="*{getTitle()}" class="fw-bold mb-0">Slide</h3></a>
                    </div>
                </div>
            </div>

            <!-- Left and right controls/icons -->
            <button class="carousel-control-prev" type="button" data-bs-target="#home-slideshow" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#home-slideshow" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>
        <a href="/Newsroom"><p class="text-1 text-decoration-underline">View more in Costi Newsroom ></p></a>
    </div>

    <!-- Axcel Minigame -->
    <div class="container-fluid overflow-hidden px-0 pt-3" id="axcel-container">
        <img id="axcel-running" th:src="@{images/games/axcel/running.gif}" class="position-relative" style="height: 0px; top:0px;left:0px;"/>
        <img id="axcel-waiting" th:src="@{images/games/axcel/sitting.gif}" class="position-relative mx-auto" style="height: 0px; top:0px;left:50%;transform:translate(-50%, 0%);"/>
    </div>

    <!-- Axcel Dialogue -->
    <div th:replace="Components :: dialogue-box"></div>

    <div class="container" id="about">
        <div class="row">
            <div class="col-md-6 col-xs-12 mb-4">
                <div class="border-box text-1 p-4">
                    <h3 class="fw-bold">What is Costi Online?</h3>
                    <p class="fs-4">Costi Online is a personal website I made to share my coding projects, video projects, wiki, Minecraft server, and more.</p>
                </div>
            </div>
            <div class="col-md-6 col-xs-12 mb-4">
                <div class="border-box text-1 p-4">
                    <h3 class="fw-bold">Who am I?</h3>
                    <p class="fs-4">Hi! I am Costi (pronounced "Coasty"). I am a computer science student at San Jose State University.</p>
                    <a href="/About#about-me" type="button" class="btn btn-primary btn-sm">About Me</a>
                </div>
            </div>
        </div>
    </div>

    <div class="container pb-5" id="new">
        <h2 class="pb-2 border-bottom">‚≠êNew In Costi Online 5.0</h2>
        <p class="fs-4">Costi Online has undergone major behind the scenes improvements. The Costi Media section of this website has been updated with new videos.</p>
        <a href="https://github.com/CKhamis/Costi-Online-Website" type="button" class="btn btn-dark btn-sm">See Costi Online on GitHub</a>
    </div>

    <div class="container-fluid p-0 gradient mb-3" id="projects">
        <div class="container-fluid">
            <div class="container py-5">
                <div class="row">
                    <div class="col-lg-6 col-md-8 col-xs-12">
                        <h2 class="fw-bold">Project Showcase</h2>
                        <p class="text-secondary">Coding projects starting from early 2011</p>
                        <p class="fs-4">Check out various coding projects I made over time and see how my skills progressed</p>
                        <h5 class="fw-bold">Project Highlights</h5>
                        <div class="row">
                            <div class="col-lg-4 col-sm-6 col-xs-6">
                                <a href="/Projects#CIPolarium"><p>[IN]GRID Polarium</p></a>
                            </div>
                            <div class="col-lg-4 col-sm-6 col-xs-6">
                                <a href="/Projects#CNGrid"><p>[NEXT]GRID</p></a>
                            </div>
                            <div class="col-lg-4 col-sm-6 col-xs-6">
                                <a href="/Projects#CIPolaris"><p>[IN]GRID Polaris</p></a>
                            </div>
                        </div>

                        <a href="/Projects" class="btn btn-primary" aria-current="page">See Projects page</a>
                        <img th:src="@{images/games/axcel/toys/Bear.png}" class="sprite" style="height:40px;" data-sprite-name="bear"/>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid p-0 mb-3" id="media">
        <div class="container-fluid">
            <div class="container py-5">
                <img th:src="@{/icons/CM White.png}" class="img-fluid mb-2"/>
                <p class="fs-4 text-white">View various video, image, and flyer materials I made. This features projects I created since I was in sixth grade in chronological order.</p>
                <a href="/Media" class="btn btn-primary" aria-current="page">Visit Costi Media</a>
            </div>
        </div>
    </div>

    <div class="container-fluid p-0" id="wiki">
        <div class="container-fluid">

            <div class="container py-5">
                <div class="row">
                    <div class="d-none d-md-block col-md-7 ">
                        <div class="row">
                            <div class="col-4" th:each="page : ${wiki}">
                                <div th:switch="${page.category}"   class="card border-box">
                                    <div th:case="INSIDE_JOKE"      class="card-header fw-bold" th:text="|&#128518; Inside Joke|">Card title</div>
                                    <div th:case="HISTORICAL"       class="card-header fw-bold" th:text="|&#127984; Historical|">Card title</div>
                                    <div th:case="PEOPLE"         class="card-header fw-bold" th:text="|&#128697; People|">Card title</div>
                                    <div th:case="PROFESSIONAL"     class="card-header fw-bold" th:text="|&#128084; Professional|">Card title</div>
                                    <div th:case="*"                class="card-header fw-bold" th:text="|&#10067; Other|">Card title</div>
                                    <div class="card-body">
                                        <h5 class="card-title text-truncate" th:text="*{page.title}">Title</h5>
                                        <h6 class="card-subtitle mb-2 text-muted text-truncate" th:text="*{page.subtitle}">Card subtitle</h6>
                                        <a th:href="'/Wiki/' + *{page.Id} + '/view'" class="card-link">View ></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-5">
                        <h2 class="fw-bold text-white">Costipedia</h2>
                        <p class="fs-4 text-white">Costipedia is a Wiki that contains pages relevant to myself & friends.</p>
                        <a href="/Wiki" class="btn btn-primary" aria-current="page">Visit Costipedia</a>
                    </div>

                </div>
            </div>
        </div>
    </div>
</main>

<div th:replace="Components :: footer"></div>
<div th:replace="Components :: scripts"></div>
<script>
    let subtitles = ["Costi's favorite website", "I haven't seen you in a BILLION years!", "Jedi Terence", "Chelsea Stacie Ingrid Marla Darla", "MAAAAARRIOOOOO!", "A project by Costi", "An interdimensional project",
    "'Ello", "üìÆüò≥üò≥üò≥", "What's puopping", "Death, Dying, Religion", "ur mum", "Free Taiwan üáπüáº ", "ü•©üáØüá≤ü•û"]

    $(document).ready(function(){
        checkGameStarted();
        $('.changing-text').text(subtitles[Math.floor(Math.random() * subtitles.length)]);
        $('.banner-logo').animate({
            width: '40%',
            marginLeft: '30%'
            });

        let quickLinks = $("#quick-links").children();
        $(quickLinks[0]).delay(0).animate({opacity: '1',
                                            marginTop: '0px'}, {duration:500})
        $(quickLinks[1]).delay(400).animate({opacity: '1',
                                            marginTop: '0px'}, {duration:500})
        $(quickLinks[2]).delay(800).animate({opacity: '1',
                                            marginTop: '0px'}, {duration:500})

        $("#axcel-running").click(startDialogue);
        $("#dialogue-skip").click(skipPressed);
        $("#dialogue-next").click(nextPressed);
        $("#axcel-waiting").click(waitingPressed);
        moveGif();
    });

    let gameStatus = -1;
    function waitingPressed(){
        //elevate gameStatus if everything was found
        if(numFoundSprites >= quota){
            gameStatus = 1;
        }

        // Start dialogue with Mr. Rat
        nextPressed();
        hideTimer();
        showDialogueBox();
    }

    let timeEnd, timeBegin;

    function checkGameStarted() {
        // Send an AJAX request to the server to check if the game has started
        $.ajax({
            url: "/games/Axcel/check-game-status",
            type: "GET",
            success: function(response) {
                quota = response.quota;
                if (response.gameStarted) {
                    // Update the UI to indicate that the game has already started
                    showAxcelWaiting();
                    numFoundSprites = response.foundSprites.length;
                    showTimer();
                    startTimer(response.timeStart);
                    timeEnd = new Date(Date.parse(response.timeEnd));
                    timeBegin = new Date(Date.parse(response.timeStart));
                    $("#toy-counter").text(numFoundSprites + " / " + quota);
                    updateSpriteVisibility(response.foundSprites);

                    showHint(countSpritesOnPage() + " toys left here!");
                    gameStatus = 0;
                } else {
                    // Show Axcel running section
                    $("#axcel-running").delay(0).animate({height: '80px'}, {duration:500});
                }
            },
            error: function(xhr, status, error) {
                // Handle any errors that occur during the AJAX request
                alert("Error checking if game has started: " + error);
            }
        });
    }

    function showAxcelWaiting(){
        $("#axcel-waiting").delay(0).animate({height: '80px'}, {duration:500});
    }

    let stage = 0;
    function startDialogue() {
        stage = 0;
        showDialogueBox();

        // Start dialogue with Mr. Rat
        $("#dialogue-message").text("WOFWOFWOFWOF. WOF. (Hi there, my name is Axcel. I'm Costi's dog, although sometimes he likes to call me Habibi. I need your help finding my lost toys. Do you think you can help me?)");
        $("#dialogue-skip").text("No. Good luck");
        $("#dialogue-next").text("Sure, what do I do?");
    }

    function showDialogueBox(){
        // Hide Axcel running section
        $("#axcel-running").delay(0).animate({height: '0px'}, {duration:500});
        $("#axcel-waiting").delay(0).animate({height: '0px'}, {duration:500});

        // Show dialogue box
        $("#dialogue-container").css("bottom", "-400px");
        $("#dialogue-container").css("display", "block");
        $("#dialogue-container").animate({ bottom: "0px" }, 700);


    }

    function skipPressed(){
        if(gameStatus == -1){
            hideDialogue();
            if(stage == 0){
                // Show Axcel running section
                $("#axcel-running").delay(1000).animate({height: '80px'}, {duration:500});
            }else if(stage >= 1){
                startGame()
                gameStatus = 0;
                stage = 0;
                showAxcelWaiting();
            }
        }else if(gameStatus == 1){
            stage = 0;
            showAxcelWaiting();
            hideDialogue();
        }
    }

    function nextPressed(){
        if(gameStatus == -1){
            // Game not started yet
            if(stage == 0){
                stage = 1;
                $("#dialogue-message").text("WOFWOF. WOF. (Thank you thank you thank you! My toys are everywhere on this website.)");
                $("#dialogue-skip").text("Skip. Start game");
                $("#dialogue-next").text("Next");
            }else if(stage == 1){
                stage = 2;
                $("#dialogue-message").text("WOFFFFFF. WOF. (You should take a look around on each page and click on them. I don't hang around the Newsroom, Minecraft or Wiki pages, so don't bother looking there.)");
            }else if(stage == 2){
                stage = 3;
                $("#dialogue-message").text("WOF. (I think I have " + quota + " toys. Once you got all of them, come back here and give them to me. I might have a surprise for you.)");
            }else if(stage == 3){
                stage = 4;
                $("#dialogue-message").text("WOFWOFWOF (Remember to come back to me when you're finished. Readyyyy? Start!)");
                $("#dialogue-skip").text("");
                startGame();
            }else{
                hideDialogue();
                gameStatus = 0;
                stage = 0;
            }
        }else if(gameStatus == 0){
            if(stage == 0){
                $("#dialogue-message").text("WOWOWOF (Hey there, I never got your name. Oh well. Do you have my toys?)");
                $("#dialogue-skip").text("");
                $("#dialogue-next").text("Not yet, how many did I find?");
                stage = 1;
            }else if(stage == 1){
                $("#dialogue-message").text("WOFWOFWF (Oh. That's disappointing. Lets see here... You have " + numFoundSprites + " toys here, but I want " + quota + " toys. Check back here once you found them.");
                $("#dialogue-skip").text("");
                $("#dialogue-next").text("Aw ok.");
                stage = 2;
            }else{
                stage = 0;
                hideDialogue();
                showTimer();
                showAxcelWaiting();
            }
        }else if(gameStatus == 1){
            if(stage == 0){
                $("#dialogue-message").text("WOWOWOF (Hey there, I never got your name. Oh well. Do you have my toys?)");
                $("#dialogue-skip").text("Scram");
                $("#dialogue-next").text("Yep!");
                stage = 1;
            }else if(stage == 1){
                let timeDifference = getTimeDifference(timeBegin, timeEnd);
                $("#dialogue-message").text("WOFFFFFF (Wow you did! I waited " + timeDifference.minutes + " minutes and " + timeDifference.seconds + " seconds. Cool!");
                $("#dialogue-next").text("Of course");
                stage = 2;
            }else if(stage == 2){
                $("#dialogue-message").text("WOF (Well, I did promise you a prize. Want to see it?)");
                $("#dialogue-next").text("Show me the prize");
                stage = 3;
            }else if(stage == 3){
                $("#dialogue-message").text("WOFWOFWOF (Here you go:)");
                $("#dialogue-message").append('<a href="/Axcel" class="text-decoration-underline">About Axcel</a>');
                $("#dialogue-next").text("Ok");
                stage = 4;
            }else{
                hideDialogue();
                showAxcelWaiting();
                stage = 0;
            }
        }
    }

    function hideDialogue(){
        $("#dialogue-container").delay(0).animate({bottom: '-400px'}, {
            duration: 700,
            complete: function() {
                $('#dialogue-container').css({
                    'bottom': '0',
                    'display': 'none'
                });
            }
        });
    }
    function startGame(){
        // Send an AJAX request to the server to start the game
        $.ajax({
            url: "/games/Axcel/start-game",
            type: "POST",
            success: function(response) {
                if (response.success) {
                    // POST successful
                    checkGameStarted();
                    return response.message;
                } else {
                    // Display error
                    alert("Error starting game: " + response.message);
                }
            },
            error: function(xhr, status, error) {
                // Display error
                alert("Error starting game: " + error);
            }
        });
    }

    let containerWidth = $('#axcel-container').width();
    let gifWidth = $('#axcel-running').width();
    let leftOffset = containerWidth + gifWidth;
    function moveGif() {
        $('#axcel-container').css('display', 'block');
        leftOffset -= 2; // animation speed

        if (leftOffset < -gifWidth) {
            leftOffset = containerWidth;
        }

        $('#axcel-running').css('left', leftOffset);
        window.requestAnimationFrame(moveGif);
    }
</script>
</body>
</html>