<!DOCTYPE html>
<html xml:th="https://www.thymeleaf.org">
<head th:replace="~{Components :: head('Projects')}"></head>
<div th:replace="~{Components :: main-navigation}"></div>

<body class="bg-1 text-1">
<div class="container-fluid row px-0 mx-0" id="all-content">
    <div class="container" id="api-content"></div>
    <img th:src="@{images/games/axcel/toys/Chuck Plush.png}" class="sprite" style="height:40px;" data-sprite-name="chuck"/>
    <div class="container" id="all-projects-container">
        <h3 id="loading" class="text-center">Connecting to Costi Online Services</h3>
    </div>
    <img src="images/games/axcel/toys/Bone.png" class="sprite" style="height: 40px;" data-sprite-name="bone">
    <div th:replace="~{Components :: footer}"></div>
</div>


<div th:replace="~{Components :: JS}"></div>
<div th:replace="~{Components :: axcel-sprite-logic}"></div>
<div th:replace="~{Components :: timer-box}"></div>
<div th:replace="~{Components :: toast-box}"></div>
<script th:replace="~{Components :: axcel-game}"></script>
<script>
    let content, projectList;

    refresh();
    function refresh(){
        fetch("/api/project/all")
            .then(response => checkStatus(response))
            .then(data => data.json())
            .then(projects => {
                console.log(projects);
                projectList = projects;
                renderProjects();
            })
            .catch((response) => {
                console.log(response);
                response.json()
                    .then(errorData => {
                        console.log(errorData);
                    })
                    .catch(error => {
                        console.error("Error parsing error response:", error);
                    });
            });
    }

    function renderProjects(){
        let projectListHTML = ``;

        projectList.forEach((project) => {
            projectListHTML += `
                <p>${project.name}</p>
            `;
        });

        document.querySelector("#all-projects-container").innerHTML = projectListHTML;
    }

</script>
</body>
</html>